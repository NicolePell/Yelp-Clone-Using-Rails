<%= flash[:notice] ? flash[:notice] : "" %>

<% if @restaurants.any? %>
	<% @restaurants.each do |restaurant| %>
		<h2> <%= link_to "#{restaurant.name}", restaurant_path(restaurant) %> </h2>

		<% if can? :update, restaurant %>
			<%= link_to "Edit #{restaurant.name}", edit_restaurant_path(restaurant) %>
		<% end %>
		<% if can? :destroy, restaurant %>
			<%= link_to "Delete #{restaurant.name}", restaurant_path(restaurant), method: :delete %>
		<% end %>

		<%= link_to "Review #{restaurant.name}", new_restaurant_review_path(restaurant) %>
		<h3>Average rating: <%= star_rating(restaurant.average_rating) %></h3>
		<% if restaurant.reviews.any? %>
			<ul>
				<% restaurant.reviews.each do |review| %>
					<li>
						<%= review.thoughts %>, <strong><%= review.rating %></strong>/5
					<span class="endorsements_count"><%= review.endorsements.count %></span> endorsements
					<%= link_to "Endorse review", review_endorsements_path(review), class: 'endorsements-link' %>
				</li>
				<% end %>
			</ul>
		<% else %>
			<p>No Reviews.</p>
		<% end %>
	<% end %>
<% else %>
	No restaurants yet
<% end %>


<a href='/restaurants/new'>Add a restaurant</a>
